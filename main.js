var data = {"responses":[{"response":{"success":{"UtilityBills":[{"utilityMeterName":"Meter9204223","utilityBillSummerDemandCharge":0,"utilityBillName":"15OCT13to15NOV10","utilityBillGenerationCost":6956.14,"utilityMeterNumber":"9204223","utilityMeterDescription":"","utilityMeterId":"f95cfdd2-a30d-4693-86c5-12557283ee35","utilityBillSummerDemandKw":0,"utilityBillId":"9b8a5bd8-a1e9-4d1f-9687-bdf35b64c8a0","utilityBillUsage":91206,"utilityBillDemandKw":309.2,"utilityBillDeliveryRateOnPeak":0.005203917,"utilityBillDemandCharge":1120.79,"utilityBillCost":3408.76,"utilityBillDeliveryRateOffPeak":0.005203953,"utilityBillDemandRate":3.624805951},{"utilityMeterName":"Meter9204225","utilityBillSummerDemandCharge":0,"utilityBillName":"15OCT13to15NOV10","utilityBillGenerationCost":5750.14,"utilityMeterNumber":"9204225","utilityMeterDescription":"","utilityMeterId":"cfd2b377-2745-40a8-8bdf-159700b0c838","utilityBillSummerDemandKw":0,"utilityBillId":"e17ecaf6-80d3-446c-866a-413431e7bc90","utilityBillUsage":82806,"utilityBillDemandKw":219.2,"utilityBillDeliveryRateOnPeak":0.005204059,"utilityBillDemandCharge":794.56,"utilityBillCost":2906.1,"utilityBillDeliveryRateOffPeak":0.005204131,"utilityBillDemandRate":3.624817518},{"utilityMeterName":"Meter9204226","utilityBillSummerDemandCharge":0,"utilityBillName":"15OCT13to15NOV10","utilityBillGenerationCost":13440.68,"utilityMeterNumber":"9204226","utilityMeterDescription":"","utilityMeterId":"91a574f0-5fc7-4bbb-b410-193ed0546e63","utilityBillSummerDemandKw":0,"utilityBillId":"f343d88a-0a84-42d4-8b65-f500c74f02e9","utilityBillUsage":209655,"utilityBillDemandKw":453.1,"utilityBillDeliveryRateOnPeak":0.005203956,"utilityBillDemandCharge":1642.4,"utilityBillCost":6418.52,"utilityBillDeliveryRateOffPeak":0.005204,"utilityBillDemandRate":3.624806886}],"Meters":[{"endValue":84687.2578125,"generationRate":0.06410855929980205,"invoiceTotal":513.689487259323,"peakDemand":29.0625,"demandCharge":105.34595012138601,"demandRate":3.624806885897153,"meterDescription":"2nd FLOOR MECHANICAL ROOM/EMONE34-480400-JO1KIT/SE #1422TMCD5084/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_024_1A1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":80253.2421875,"meterId":"1ccb9e52-f36e-4c8d-a97d-683b04570497","genProvider":"PSE&G","peakTime":"29-Oct-2015 04:00 AM EDT","usage":4434.015625,"serviceCharge":124.08518350637563,"generationCharge":284.25835363156136,"svcProvider":"PSE&G"},{"endValue":79058.4453125,"generationRate":0.06410855929980205,"invoiceTotal":553.2691150549401,"peakDemand":38.53125,"demandCharge":139.66834032222468,"demandRate":3.624806885897153,"meterDescription":"3rd FLOOR MECHANICAL ROOM/EMONE34-480400-J01KIT/SE #1422TMCD5093/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_024_1B1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":74567.34375,"meterId":"435f4c7f-86d7-460a-aeae-fffc6127f165","genProvider":"PSE&G","peakTime":"29-Oct-2015 04:30 AM EDT","usage":4491.1015625,"serviceCharge":125.68272389175056,"generationCharge":287.9180508409649,"svcProvider":"PSE&G"},{"endValue":88635.9921875,"generationRate":0.06410855929980205,"invoiceTotal":617.7252987041218,"peakDemand":40.25,"demandCharge":145.89847715736042,"demandRate":3.624806885897153,"meterDescription":"4th FLOOR MECHANICAL ROOM/EMONE34-480400-J01KIT/SE #1422TMCD5096/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_024_1C1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":83512.640625,"meterId":"29574054-16f1-42d5-bc80-c0409435a208","genProvider":"PSE&G","peakTime":"29-Oct-2015 04:15 AM EDT","usage":5123.3515625,"serviceCharge":143.37613408849654,"generationCharge":328.4506874582648,"svcProvider":"PSE&G"},{"endValue":85725.375,"generationRate":0.06410855929980205,"invoiceTotal":588.7830656955476,"peakDemand":28.5,"demandCharge":103.30699624806886,"demandRate":3.624806885897153,"meterDescription":"5th FLOOR MER/EMONE34-480400-J01KIT/SE #1422TMCD5081/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_024_1D1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":80453.8125,"meterId":"22b09e87-2dfb-441c-9654-a210d5b4cbb7","genProvider":"PSE&G","peakTime":"28-Oct-2015 03:15 PM EDT","usage":5271.5625,"serviceCharge":147.523792313616,"generationCharge":337.95227713386276,"svcProvider":"PSE&G"},{"endValue":124631.390625,"generationRate":0.06410855929980205,"invoiceTotal":1124.199132705394,"peakDemand":46.46875,"demandCharge":168.44024497903334,"demandRate":3.624806885897153,"meterDescription":"2nd FLOOR NORTH CLOSET/EMONE34-480400-J01KIT/SE #1422TMCD5039/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_024_2A1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":114253.2421875,"meterId":"c06433f0-02eb-4047-b6d8-d62986d97658","genProvider":"PSE&G","peakTime":"20-Oct-2015 11:15 AM EDT","usage":10378.1484375,"serviceCharge":290.4307431987439,"generationCharge":665.3281445276168,"svcProvider":"PSE&G"},{"endValue":160632.265625,"generationRate":0.06410855929980205,"invoiceTotal":1049.6437844274833,"peakDemand":28.875,"demandCharge":104.6662988302803,"demandRate":3.624806885897153,"meterDescription":"2nd FLOOR NORTH CLOSET/EMONE34-480400-J01KIT/SE #1422TMCD5091/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_024_2B1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":150371.1875,"meterId":"b33e8d17-22cb-448c-8eed-0b7d566bb333","genProvider":"PSE&G","peakTime":"27-Oct-2015 10:45 AM EDT","usage":10261.078125,"serviceCharge":287.15455014073876,"generationCharge":657.8229354564642,"svcProvider":"PSE&G"},{"endValue":88585.328125,"generationRate":0.06410855929980205,"invoiceTotal":743.620544625066,"peakDemand":20.3125,"demandCharge":73.62888986978592,"demandRate":3.624806885897153,"meterDescription":"3rd FLOOR NORTH CLOSET/EMONE34-480400-J01KIT/SE #1422TMCD5090/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_024_2C1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":81310.1953125,"meterId":"75142b0b-7f3b-4ec5-bda6-c60030a3358a","genProvider":"PSE&G","peakTime":"13-Oct-2015 04:00 PM EDT","usage":7275.1328125,"serviceCharge":203.5933714311882,"generationCharge":466.39828332409195,"svcProvider":"PSE&G"},{"endValue":92032.375,"generationRate":0.06410855929980205,"invoiceTotal":738.382844317594,"peakDemand":19.96875,"demandCharge":72.38286250275877,"demandRate":3.624806885897153,"meterDescription":"4th FLOOR NORTH CLOSET/EMONE34-480200-J01KIT/SE #1423TMCD5072/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_024_2D1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":84800.5859375,"meterId":"410ecafd-f81c-4b44-b943-7a017a417baa","genProvider":"PSE&G","peakTime":"28-Oct-2015 12:15 PM EDT","usage":7231.7890625,"serviceCharge":202.3804038578941,"generationCharge":463.61957795694116,"svcProvider":"PSE&G"},{"endValue":165777.052734375,"generationRate":0.06410855929980205,"invoiceTotal":1515.0141199109744,"peakDemand":24.453125,"demandCharge":88.63785588170381,"demandRate":3.624806885897153,"meterDescription":"4th FLOOR NORTH CLOSET/EMONE34-480-100-J01KIT/SE #1422TMCD5073/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_024_2E1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":150288.685546875,"meterId":"1ab5b2a0-a848-4790-8af2-dcfa6f00db98","genProvider":"PSE&G","peakTime":"28-Oct-2015 12:15 PM EDT","usage":15488.3671875,"serviceCharge":433.4393577323184,"generationCharge":992.9369062969521,"svcProvider":"PSE&G"},{"endValue":88229.54296875,"generationRate":0.06410855929980205,"invoiceTotal":739.4336143633666,"peakDemand":21.171875,"demandCharge":76.74395828735379,"demandRate":3.624806885897153,"meterDescription":"5th FLOOR NORTH CLOSET/EMONE34-480200-J01KIT/SE #1423TMCD5069/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_024_2F1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":81033.69921875,"meterId":"13ca00f1-e142-45f8-9beb-e06c063a0dba","genProvider":"PSE&G","peakTime":"27-Oct-2015 11:30 AM EDT","usage":7195.84375,"serviceCharge":201.37448031702777,"generationCharge":461.315175758985,"svcProvider":"PSE&G"},{"endValue":48903.19140625,"generationRate":0.06410855929980205,"invoiceTotal":359.30636737675843,"peakDemand":7.84375,"demandCharge":28.432079011255794,"demandRate":3.624806885897153,"meterDescription":"6th FLOOR NORTH CLOSET/EMONE34-480200-J01KIT/SE #1423TMCD5083/ 1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_024_2G1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":45310.37890625,"meterId":"68099e1f-9046-4c56-82ec-bb2b67d9c791","genProvider":"PSE&G","peakTime":"14-Oct-2015 08:45 AM EDT","usage":3592.8125,"serviceCharge":100.54425515618253,"generationCharge":230.33003320932008,"svcProvider":"PSE&G"},{"endValue":119240.15625,"generationRate":0.06944110330169312,"invoiceTotal":1069.062356039904,"peakDemand":24.3125,"demandCharge":88.12837591240876,"demandRate":3.624817518248175,"meterDescription":"2nd FLOOR SOUTH ELECTRIC/EMONE34480400J01KIT/SE#1422TMCD5082/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.030703938006545417,"meterName":"SEM_025_3A1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":109445.0234375,"meterId":"66bbdfeb-e6bd-4e9d-bf9d-f5d470fa1277","genProvider":"PSE&G","peakTime":"15-Oct-2015 12:00 PM EDT","usage":9795.1328125,"serviceCharge":300.74915064087884,"generationCharge":680.1848294866163,"svcProvider":"PSE&G"},{"endValue":25594.42578125,"generationRate":0.06944110330169312,"invoiceTotal":110.06499336251139,"peakDemand":2.3515625,"demandCharge":8.523984945255474,"demandRate":3.624817518248175,"meterDescription":"2nd FLLOR SOUTH ELECTRIC/EMONE34480400J01KIT/SE#1422TMCD5038/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.030703938006545417,"meterName":"SEM_025_3B1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":24580.486328125,"meterId":"eed12097-691d-45ea-9b7c-8aac41d66be6","genProvider":"PSE&G","peakTime":"22-Oct-2015 02:15 PM EDT","usage":1013.939453125,"serviceCharge":31.131934111140563,"generationCharge":70.40907430611536,"svcProvider":"PSE&G"},{"endValue":104682.8125,"generationRate":0.06410855929980205,"invoiceTotal":852.4124416313041,"peakDemand":24.4375,"demandCharge":88.58121827411168,"demandRate":3.624806885897153,"meterDescription":"3rd FLOOR SOUTH ELECTRIC/EMONE34480400J01KIT/SE#1422TMCD5083/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_025_3C1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":96388.71875,"meterId":"dcf28e70-1699-4a16-8e4a-349d875102d9","genProvider":"PSE&G","peakTime":"13-Oct-2015 01:45 PM EDT","usage":8294.09375,"serviceCharge":232.1088223471998,"generationCharge":531.7224010099926,"svcProvider":"PSE&G"},{"endValue":166725.2109375,"generationRate":0.06410855929980205,"invoiceTotal":1100.8202154657238,"peakDemand":20.0625,"demandCharge":72.72268814831163,"demandRate":3.624806885897153,"meterDescription":"3rd FLOOR SOUTH ELECTRIC/EMONE34480400J01KIT/SE# 1422TMCD5040/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_025_3D1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":155561.5703125,"meterId":"e2ab3461-bde9-4a16-adf6-31902f5d8784","genProvider":"PSE&G","peakTime":"18-Oct-2015 03:00 PM EDT","usage":11163.640625,"serviceCharge":312.4126103079203,"generationCharge":715.6849170094918,"svcProvider":"PSE&G"},{"endValue":75131.546875,"generationRate":0.06410855929980205,"invoiceTotal":633.4563260516713,"peakDemand":21.375,"demandCharge":77.48024718605164,"demandRate":3.624806885897153,"meterDescription":"4th FLOOR SOUTH ELECTRIC/EMONE34480200J01KIT/SE# 1423TMCD5079/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_025_3E1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":69094.45703125,"meterId":"1a22209c-e0f5-4957-868e-9d7a52e6d85b","genProvider":"PSE&G","peakTime":"21-Oct-2015 10:00 AM EDT","usage":6037.08984375,"serviceCharge":168.94694661934017,"generationCharge":387.0291322462796,"svcProvider":"PSE&G"},{"endValue":102496.328125,"generationRate":0.06410855929980205,"invoiceTotal":856.6129221193022,"peakDemand":24.453125,"demandCharge":88.63785588170381,"demandRate":3.624806885897153,"meterDescription":"5th FLOOR SOUTH ELECTRIC/EMONE34480200J01KIT/SE# 1423TMCD5078/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_025_3F1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":94157.23828125,"meterId":"88bc8861-d4d4-43fc-b14f-4e885283b15f","genProvider":"PSE&G","peakTime":"21-Oct-2015 02:00 PM EDT","usage":8339.08984375,"serviceCharge":233.3680304831745,"generationCharge":534.6070357544239,"svcProvider":"PSE&G"},{"endValue":51172.796875,"generationRate":0.06410855929980205,"invoiceTotal":288.1352976378969,"peakDemand":9,"demandCharge":32.62326197307438,"demandRate":3.624806885897153,"meterDescription":"6th FLOOR SOUTH ELECTRIC/EMONE34480200J01KIT/SE# 1422TMCD5080/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.02798483226057094,"meterName":"SEM_025_3H1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":48398.30859375,"meterId":"69f6075f-cfc8-40e3-b377-7b4ab836e343","genProvider":"PSE&G","peakTime":"14-Oct-2015 07:30 AM EDT","usage":2774.48828125,"serviceCharge":77.64358915970102,"generationCharge":177.8684465051215,"svcProvider":"PSE&G"},{"endValue":80365.015625,"generationRate":0.07626844725127734,"invoiceTotal":398.88717410633035,"peakDemand":20.5625,"demandCharge":74.53507236416559,"demandRate":3.6248059508408796,"meterDescription":"6th FLOOR SOUTH ELECTRIC/EMONE34480400J01KIT/SE# 1422TMCD5089/1 SET OF CURRENT SENSORS","endTime":"2015-11-11 00:00:00.0000000 -05:00","serviceRate":0.030289674973247378,"meterName":"SEM_026_3G1","startTime":"2015-10-13 00:00:00.0000000 -04:00","startValue":77321.1171875,"meterId":"e76e9901-95ef-417f-ba3b-df1cd8a8a4c2","genProvider":"PSE&G","peakTime":"28-Oct-2015 04:15 PM EDT","usage":3043.8984375,"serviceCharge":92.19869432345055,"generationCharge":232.15340741871424,"svcProvider":"PSE&G"}],"Invoice":{"generationRate":0.024455479080121245,"building":{"zip":"","buildingName":"B0011","state":"None","addresss1":"221 River St","buildingDisplayName":"Waterfront Corporate Center Phase III","addresss2":"221 River St","squareFootage":592897,"buildingId":"bfbc3bf8-1794-4f52-9ac4-72310603edff","country":"None","city":""},"invoiceTotal":13852.519100855216,"tenantEnergyUsage":131204.576171875,"demandCharge":1638.384657896295,"demandRate":3.6248089658685685,"tenantPeakKw":386.78125,"tenantPercentUsage":34.197514034794494,"invoiceNumber":"0001687","serviceRate":0.024455479080121245,"billingDays":29,"utilityBillUsage":383667,"start":"2015-10-13","utilityBillDemandKw":981.5,"utilityBillDeliveryRateOnPeak":0.0052039773333333325,"dateGenerated":"2015-12-17T14:30:00.797-08:00","utilityBillDemandCharge":3557.75,"utilityBillCost":12733.380000000001,"utilityBillDeliveryRateOffPeak":0.005204028,"serviceCharge":3708.144773627138,"generationCharge":8505.989669331782,"end":"2015-11-10"},"type":"csi3tenantserver:Csi3TenantServerPowerFlatRateWithDemandInvoice"}},"request":{"trends":"false","request":"getInvoice","invoiceNumber":"0001687"}}]}


//NOTE: the data will be JSON so you need to parse it before using it

var dollarFormat = function(num){
  num = Math.round(num * 100) / 100;
  var string = num.toString().split('.');
  var dollars = string[0].split('').reverse().join('');
  var cents = string[1];
  var arr = [];
  if(!cents || cents.length === 0){
    cents = '00'
  }
  for(var i = 0; i < dollars.length; i++){
    arr.push(dollars[i]);
    if((i + 1) % 3 === 0 && i !== dollars.length - 1){
      arr.push(',');
    }
  }
  dollars = arr.reverse().join('');
  return dollars + '.' + cents;
};


var months = {
  '01' : 'Jan',
  '02' : 'Feb',
  '03' : 'Mar',
  '04' : 'Apr',
  '05' : 'May',
  '06' : 'Jun',
  '07' : 'Jul',
  '08' : 'Aug',
  '09' : 'Sep',
  '10' : 'Oct',
  '11' : 'Nov',
  '12' : 'Dec'
}

var dateFormat = function(date){
  date = date.split('-');
  var year = date[0];
  var month = date[1];
  var day = date[2].substring(0,2);
  return day + ' ' + months[month] + ' ' + year;
};

var fourDeci = function(num){
  num = Math.round(num * 10000) / 10000;
  var str = num.toString().split('.');
  var wholeNum = str[0].split('').reverse().join('');
  var decimal = str[1];
  if(!decimal || decimal.length === 0){
    decimal = '00'
  }
  var arr = [];
  for(var i = 0; i < wholeNum.length; i++){
    arr.push(wholeNum[i]);
      if((i + 1) % 3 === 0 && i !== wholeNum.length - 1){
        arr.push(',');
      }
  }
  wholeNum = arr.reverse().join('');
  return wholeNum + '.' + decimal;
};


$(document).ready(function(){

  var invoice = data.responses[0].response.success.Invoice;
  //below returns an array of objects
  var utility = data.responses[0].response.success.UtilityBills;
  //below returns an array of objects
  var meters = data.responses[0].response.success.Meters;

  var summaryUtil = '';
  for(var i = 0; i < utility.length; i++){
    if(i === utility.length - 1){
      summaryUtil += utility[i].utilityMeterNumber;
    }else{
      summaryUtil += utility[i].utilityMeterNumber + ', ';
    }
  }

  // var planType = null;

  var meterCount = meters.length;
  //fill out account info
  $('#invoice-data').append('<table class="table"><tbody><tr><td>Account Name: </td><td>' + invoice.building.buildingDisplayName + '</td><td>Invoice Date: </td><td>' + dateFormat(invoice.dateGenerated) + '</td></tr><tr><td>Address: </td><td>' + invoice.building.addresss1 + '<br>' + invoice.building.city + ', ' + invoice.building.state + '</td><td>Invoice Number: </td><td>' + invoice.invoiceNumber + '</td></tr><tr><td>Contract Plan Type: </td><td>Flat Rate</td></tr></tbody></table>');
  //end account info

  //populate utility details
  for(var i = 0; i < utility.length; i++){
    var cur = utility[i]
    // $('#utility-details').append("<div class='inner-utility'><b>Meter " + (i + 1) + ":</b><br> Meter Name: " + cur.utilityMeterName + "<br> Meter Number: " + cur.utilityMeterNumber + "<br> Usage: " + fourDeci(cur.utilityBillUsage) + "kWh<br> Peak Demand: " + fourDeci(cur.utilityBillDemandKw) + "kWh </div>");
    $('#utility-details').append('<table class="table table-noborder inner-utility"><thead><th>Meter: ' + (i + 1) + '</th></thead><tbody><tr><td>Meter Name:</td><td>' + cur.utilityMeterName + '</td></tr><tr><td>Meter Number:</td><td>' + cur.utilityMeterNumber + '</td></tr><tr><td>Usage:</td><td>' + fourDeci(cur.utilityBillUsage) + ' kWh</td></tr><tr><td>Peak Demand:</td><td>' + fourDeci(cur.utilityBillDemandKw) + ' kWh</td></tr></tbody></table>');
  }
  //end utility details

  //populate current usage
  $('#current-usage').append('<table class="table usage-table"><thead><tr><th>Meter Count</th><th>Billing Days</th><th>Billing Period</th><th>Usage (kWh)</th><th>Peak Demand (kW)</th></tr></thead><td class="text-center">' + meters.length + '</td><td class="text-center">' + invoice.billingDays + '</td><td>' + dateFormat(invoice.end) + '</td><td>' + fourDeci(invoice.tenantEnergyUsage) + '</td><td>' + fourDeci(invoice.tenantPeakKw) + '</td></table>');
  //end current usage

  //populate current charges

  $('#current-charges').append('<table class="table usage-table"><thead><tr><th>Current Charges</th><th>Start Date</th><th>End Date</th><th>Total</th></tr></thead><tbody><tr><td>Service Charge</td><td>' + invoice.start + '</td><td>' + invoice.end + '</td><td>$' + dollarFormat(invoice.serviceCharge) + '</td></tr><tr><td>Demand Charge</td><td></td><td></td><td>$' + dollarFormat(invoice.demandCharge) + '</td></tr><tr><td>Generation Charge</td><td></td><td></td><td>$' + dollarFormat(invoice.generationCharge) + '</td></tr><tr><th>Total Current Charges</th><td></td><td></td><th>$' + dollarFormat(invoice.invoiceTotal) + '</th></tr></tbody></table>');

  //end current charges

  //populate summary information
  $('#summary-information').append('<div class="row inner-summary"><div class="col-md-7"></div><div class="col-md-5"><table class="table table-noborder inner-summary"><thead><tr><th>Bill Summary:</th></tr></thead><tbody><tr><td>Account Name: </td><td>' + invoice.building.buildingDisplayName + '</td></tr><tr><td>Invoice Number:</td><td>' + invoice.invoiceNumber + '</td></tr><tr></td><td>Utility Numbers:</td><td>' + summaryUtil + '</td></tr><tr><td>Current Charges:</td><td>$' + dollarFormat(invoice.invoiceTotal) + '</td></tr><tr><td>Invoice created using:</td><td> <span class="tenant-eye">tenant <span class="red-font">eye</span></span></td></tr></tbody></table></div></div>');
  //end summary information

  //populate meter details
  var divs = 1;
  var metersPerPage = 3;
  for(var i = 0; i < meterCount; i++){
    var  cur = meters[i];
    var total = cur.serviceCharge + cur.demandCharge + cur.generationCharge;

    if(i === 0){
      $('#meter-details').append('<div class="repeater img-rounded pagebreak"><div class="sub-heading gray-head special">Meter Details</div>');
    }

    // $('#meter-details > div:nth-child(' + divs + ')').append('<div class="row inner-meter"><div class="col-md-2"><b>Meter ' + (i + 1) + ':</b><br>Meter Name:<br>Description:<br>Peak Demand:<br>Peak Time:<br>Start:<br>End:</div><div class="col-md-5"><br>' + cur.meterName + '<br>' + cur.meterDescription + '<br>' + cur.peakDemand + 'kW<br>' + cur.peakTime + '<br>' + cur.startTime + '<br>  ' + cur.startValue + '<br>' + cur.endTime + '<br>  ' + cur.endValue + '</div><div class="col-md-3"><br>Service Charge (' + cur.svcProvider + '): <br>' + dollarFormat(cur.usage) + 'kWh @ $' + fourDeci(cur.serviceRate) + '<br><br>Demand Charge (' + cur.svcProvider + '):<br>' + dollarFormat(cur.peakDemand) + 'kW @ $' + fourDeci(cur.demandRate) + '<br><br>Generation Charge (' + cur.genProvider + '):<br>' + dollarFormat(cur.usage) + 'kWh @ $' + fourDeci(cur.generationRate) + '<br><br><b>Total: </b></div><div class="col-md-2"><br><b>$' + dollarFormat(cur.serviceCharge) + '</b><br><br><br><b>$' + dollarFormat(cur.demandCharge) + '</b><br><br><br><b>$' + dollarFormat(cur.generationCharge) + '</b><br><br><br><b>$' + dollarFormat(total) + '</b></div></div>');

      $('#meter-details > div:nth-child(' + divs + ')').append('<div class="inner-meter"><table class="table table-noborder"><thead><th>Meter ' + (i + 1) + ' :</th></thead><tbody><tr><td class="col-one">Meter Name:</td><td class="col-two">' + cur.meterName + '</td><td class="col-three">Service Charge (' + cur.svcProvider + '):<br>' + fourDeci(cur.usage) + 'kWh @ $' + fourDeci(cur.serviceRate) + '</td><th class="col-four">$' + dollarFormat(cur.serviceCharge) + '</th></tr><tr><td>Description:</td><td class="long-name">' + cur.meterDescription + '</td><td></td></tr><tr><td>Peak Demand:</td><td>' + cur.peakDemand + 'kW</td><td>Demand Charge (' + cur.svcProvider + '):<br>' + fourDeci(cur.peakDemand) + ' @ $' + fourDeci(cur.demandRate) + '</td><th>$' + dollarFormat(cur.demandCharge) + '</th></tr><tr><td>Peak Time:</td><td>' + cur.peakTime + '</td></tr><tr><td>Start:</td><td>' + dateFormat(cur.startTime) + '<br>' + fourDeci(cur.startValue) + ' kWh</td><td>Generation Charge (' + cur.genProvider + '):<br>' + fourDeci(cur.usage) + 'kWh @ $' + fourDeci(cur.generationRate) + '</td><th>$' + dollarFormat(cur.generationCharge) + '</th></tr><tr><td>End:</td><td>' + dateFormat(cur.endTime) + '<br>' + fourDeci(cur.endValue) + ' kWh</td><th><br>Total:</th><th><br>$' + dollarFormat(total) + '</th></tr></tbody></table></div>');

    if((i + 1 ) % metersPerPage === 0 || i === meterCount - 1){
      var lastDiv = metersPerPage + 1;

      if(i === meterCount - 1){
        // $('#meter-details > div:nth-child(' + divs + ') > div:nth-child(' + (((i + 1) % metersPerPage)+1) + ')').addClass('last-row');
        lastDiv = ((i + 1) % metersPerPage) + 1;
      }

      $('#meter-details > div:nth-child(' + divs + ') > div:nth-child(' + lastDiv + ')').addClass('last-row');
      $('#meter-details').append('</div>');
      if((i + 1) % metersPerPage === 0){
        $('#meter-details').append('<div class="repeater img-rounded pagebreak"><div class="sub-heading gray-head special">Meter Details</div>');
      }
      divs++;
    }//end if

  }
  //end meter details
});

